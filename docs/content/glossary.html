<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>认识POM对象 | WeChatAuto.SDK </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="认识POM对象 | WeChatAuto.SDK ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../Images/logo.png" alt="WECHATAUTO.SDK">
            WECHATAUTO.SDK
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="认识pom对象">认识POM对象</h1>

<hr>
<p>WeChatAuto.SDK 基于 POM（页面对象模型）设计理念，对微信的不同操作场景进行了清晰、模块化的对象封装。只需要了解各个 POM 对象及其对应的微信界面组件，即可调用这些对象的公开方法和属性，简化功能实现与维护。</p>
<h2 id="-wechatautosdk-pom-组件结构图">🚀 WeChatAuto.SDK POM 组件结构图</h2>
<p><img src="https://raw.githubusercontent.com/scottfly189/WeChatAuto.SDK/master/Images/class.png" alt="WeChatAuto.SDK 主要类关系示意"></p>
<h2 id="-wechatautosdk的页面组件介绍">🎁 WeChatAuto.SDK的页面组件介绍</h2>
<h3 id="1-wechatclientfactory组件">1. WeChatClientFactory组件</h3>
<p><span style="color: #999;">本组件无UI</span></p>
<p>WeChatClientFactory组件是非常重要的核心组件，负责多微信客户端的统一管理。SDK初始化后，可以通过依赖注入获取该组件。随后，可以通过WeChatClientFactory组件获取具体的微信客户端（<a href="/api/WeChatAuto.Components.WeChatClient.html">WeChatClient</a>）实例，实现对不同微信账号的操作和管理。</p>
<pre><code class="lang-csharp">// 初始化WeAutomation服务
var serviceProvider = WeAutomation.Initialize(options =&gt;
{
    options.DebugMode = true;   //开启调试模式，调试模式会在获得焦点时边框高亮，生产环境建议关闭
    //options.EnableRecordVideo = true;  //开启录制视频功能，录制的视频会保存在项目的运行目录下的Videos文件夹中
});
//获取到WeChatClientFactory
using var clientFactory = serviceProvider.GetRequiredService&lt;WeChatClientFactory&gt;();
</code></pre>
<blockquote>
<p>由于WeChatClientFactory是以<code>Singletion</code>的方式加入依赖注入容器中，所以我们可以很方便的通过构造器注入等方式获取到它,具体请参考<a href="/api/WeChatAuto.Components.WeChatClientFactory.html">WeChatClientFactory</a></p>
</blockquote>
<ul>
<li>WeChatClientFactory组件的Initialize()方法的参数WeChatConfig配置对象说明：</li>
</ul>
<table>
<thead>
<tr>
<th>属性名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>CaptureUIPath</td>
<td>捕获UI保存路径 默认保存到当前目录下的Capture文件夹,可以修改为其他路径</td>
</tr>
<tr>
<td>ListenInterval</td>
<td>消息监听的时间间隔,单位：秒，默认5秒监听一次</td>
</tr>
<tr>
<td>MomentsListenInterval</td>
<td>朋友圈监听的时间间隔,单位：秒，默认10秒监听一次</td>
</tr>
<tr>
<td>NewUserListenerInterval</td>
<td>监听新用户的时间间隔，单位：秒，默认5秒监听一次</td>
</tr>
<tr>
<td>MonitorSubWinInterval</td>
<td>监听子窗口时间间隔，单位秒,默认5秒监听一次</td>
</tr>
<tr>
<td>DebugMode</td>
<td>是否启用调试模式，启用了调试模式可以在运行时看到按钮高亮，默认false</td>
</tr>
<tr>
<td>EnableRecordVideo</td>
<td>是否启用视频录制，如果启用，可以录制整个自动化运行过程，默认false</td>
</tr>
<tr>
<td>TargetVideoPath</td>
<td>自定义视频录制文件保存位置，默认保存到当前目录下的Video文件夹,可以修改为其他路径</td>
</tr>
<tr>
<td>EnableMouseKeyboardSimulator</td>
<td>是否启用鼠标键盘模拟器,启用后，键盘鼠标操作会通过模拟器进行操作，而不是通过windows automation进行操作,注意：需要购买键鼠模拟器，并在此处启用</td>
</tr>
<tr>
<td>KMDeiviceVID</td>
<td>配置键鼠模拟器设备VID</td>
</tr>
<tr>
<td>KMDeivicePID</td>
<td>配置键鼠模拟器设备PID</td>
</tr>
<tr>
<td>KMVerifyUserData</td>
<td>配置键鼠模拟器用户校验数据</td>
</tr>
<tr>
<td>OutputStringType</td>
<td>配置键鼠模拟器输出字符串编码类型,默认使用剪贴板粘贴输出字符串。优点是输出字符多时速度更快且不受输入法影响</td>
</tr>
<tr>
<td>MouseMoveMode</td>
<td>配置键鼠模拟器鼠标移动模式</td>
</tr>
<tr>
<td>OffsetOfClick</td>
<td>点击偏移量,单位像素,为了避免每次点击都点击到同一个位置，可以设置一个偏移量，实际点击位置为点击位置减去偏移量的一个随机值</td>
</tr>
<tr>
<td>ProcessDpiAwareness</td>
<td>进程DPI感知值,如果使用库的应用已经设置DPI感知，此参数无效，可设置参数为:0: 不设置,进程对DPI完全不知晓，按逻辑像素绘制，可能会出现点击不准确的情况。1: PROCESS_SYSTEM_DPI_AWARE 默认值,进程只根据主显示器DPI绘制，DPI感知生效。 2: PROCESS_PER_MONITOR_DPI_AWARE，进程根据每个显示器DPI绘制,DPI感知生效。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>更具体的了解WeChatConfig配置对象，请参考: <a href="/api/WeAutoCommon.Configs.WeChatConfig.html">WeChatConfig配置对象</a></p>
</blockquote>
<h3 id="2-wechatclient组件">2. WeChatClient组件</h3>
<p><strong>WeChatClient</strong>组件代表一个微信客户端对象</p>
<p><span style="color: #999;">本组件无UI</span></p>
<ul>
<li>通过WeChatClientFactory获取到WeChatClient对象</li>
<li>WeChatClient对象使用委托模式转发调用其他各个组件的方法：如：消息管理，监听等，让客户端只需与 WeChatClient 交互，而不需要了解底层组件</li>
<li>更具体请参见<a href="/api/WeChatAuto.Components.WeChatClient.html">WeChatClient</a>类</li>
</ul>
<h3 id="3-wechatnotifyicon组件">3. WeChatNotifyIcon组件</h3>
<p>本组件抽象了任务栏的微信图标,如下图所示:</p>
<img src="../Images/notifyicon.png" alt="WeChatNotifyIcon" width="450">
<blockquote>
<p>可以通过WeChatClient.WxNotifyIcon属性获取到WeChatNotifyIcon对象，并执行方法;</p>
</blockquote>
<h3 id="4-wechatmainwindow组件">4. WeChatMainWindow组件</h3>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://github.com/scottfly189">Alex Zhao</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
