# æ¶ˆæ¯ç®¡ç†
---

> æ³¨ï¼šæ•™ç¨‹ä¸­"å¥½å‹æ˜µç§°"ä¸"å¥½å‹æ˜µç§°"å…·æœ‰åŒæ ·çš„è¯­ä¹‰

## ğŸš€ æ¶ˆæ¯å‘é€æ¨¡å‹
WeChatAuto.SDKæ”¯æŒä¸¤ç§æ¶ˆæ¯å‘é€æ¨¡å‹:

- **å•ç‹¬å‘é€æ¶ˆæ¯**

  é€‚ç”¨äºå•å‘ã€ç¾¤å‘ã€è½¬å‘ç­‰ç®€å•èŠå¤©åœºæ™¯ã€‚

- **èŠå¤©è¿‡ç¨‹æ¶ˆæ¯å›å¤**

  é€‚ç”¨äºåœ¨èŠå¤©è¿‡ç¨‹ä¸­è¿›è¡Œæ¶ˆæ¯å›å¤ï¼Œç‰¹åˆ«é€‚åˆæ¥å…¥å¤§æ¨¡å‹å®ç°è‡ªåŠ¨å›å¤çš„åœºæ™¯ã€‚

## ğŸ˜Š å•ç‹¬å‘é€æ¶ˆæ¯

> å…·ä½“è¯·å‚è€ƒæºç : ```é¡¹ç›®æ ¹ç›®å½•\Examples\demo03```

### 1. å‘é€æ–‡æœ¬æ¶ˆæ¯
 - å¯ä»¥é€šè¿‡```WeChatClient```ç±»æˆ–è€…```WeChatMainWindow```ç±»å‘é€æ¶ˆæ¯,æˆ–è€…é€šè¿‡çª—å£ç±»```WeChatMainWindow```è·å¾—```Sender```å¯¹è±¡æ¥å‘é€æ¶ˆæ¯
 - æ–¹æ³•å®šä¹‰
 ```
 public async Task SendWho(string who, string message, OneOf<string, string[]> atUser = default, bool isOpenChat = true)
 ```
 
 å…¶ä¸­ï¼š
   - who: å¥½å‹æ˜µç§°ï¼Œå¯ä»¥æ˜¯å¥½å‹æˆ–è€…ç¾¤æ˜µç§°
   - message: æ¶ˆæ¯å†…å®¹
   - atUser: è¢«@çš„å¥½å‹æ˜µç§°ï¼Œå¯ä»¥å•ä¸ªå¥½å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¥½å‹æ•°ç»„ï¼Œé€‚ç”¨ç¾¤èŠä¸­@å¥½å‹
   - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€
 - ç¤ºä¾‹ä»£ç :
 ```
 /***
 * ç¤ºä¾‹ä¸‰ - æ¶ˆæ¯ç®¡ç†æ¼”ç¤º
 */

using WeChatAuto.Services;
using WeChatAuto.Components;
using Microsoft.Extensions.DependencyInjection;

var serviceProvider = WeAutomation.Initialize(options =>
{
    options.DebugMode = true;
});

using var clientFactory = serviceProvider.GetRequiredService<WeChatClientFactory>();
var client = clientFactory.GetWeChatClient("Alex");
//å‘é€æ¶ˆæ¯ç»™AI.Netå¥½å‹æ˜µç§°ï¼Œè¯·ä¿®æ”¹æˆè‡ªå·±çš„å¥½å‹æ˜µç§°
await client.SendWho("AI.Net", "ä½ å¥½ï¼Œä¸–ç•Œï¼");
//å‘é€æ¶ˆæ¯ç»™ç¾¤èŠ"æµ‹è¯•11"ï¼Œå¹¶@å¥½å‹:123321
await client.SendWho("æµ‹è¯•11", "ä½ å¥½ï¼Œä¸–ç•Œï¼", "123321");
//å‘é€æ¶ˆæ¯ç»™ç¾¤èŠ"æµ‹è¯•11"ï¼Œå¹¶@å¥½å‹:123321,Alex
await client.SendWho("æµ‹è¯•11","ä½ å¥½ï¼Œä¸–ç•Œï¼",new string[]{"123321","Alex"});
 ```

### 2. å‘é€Emojiè¡¨æƒ…

> æ³¨ï¼šEmoji è¡¨æƒ…å¯ä»¥å•ç‹¬å‘é€ï¼Œä¹Ÿå¯ä»¥åŒ…å«åœ¨æ–‡å­—æ¶ˆæ¯ä¸­ï¼Œå…¶ä»–ç”¨æ³•åŒä¸Šé¢çš„[å‘é€æ–‡æœ¬æ¶ˆæ¯](#1-å‘é€æ–‡æœ¬æ¶ˆæ¯)

- æ–¹æ³•å®šä¹‰:
```
public async Task SendEmoji(string who, OneOf<int, string> emoji, OneOf<string, string[]> atUser = default, bool isOpenChat = false)
```
å…¶ä¸­:
  - who: å¥½å‹æ˜µç§°ï¼Œå¯ä»¥æ˜¯å¥½å‹æˆ–è€…ç¾¤æ˜µç§°
  - emoji: å¯ä»¥æ˜¯è¡¨æƒ…åç§°æˆ–è€…æè¿°æˆ–è€…ç´¢å¼•,å…·ä½“ç´¢å¼•æˆ–è€…æè¿°ç­‰è¯·å‚è€ƒä¸‹é¢çš„Emojiè¡¨
  - atUser: è¢«@çš„å¥½å‹æ˜µç§°ï¼Œå¯ä»¥å•ä¸ªå¥½å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¥½å‹æ•°ç»„ï¼Œé€‚ç”¨ç¾¤èŠä¸­@å¥½å‹
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

- Emojiè¡¨å‚è€ƒ

> Emojiè¡¨æŒ‰æ‰“å¼€å¾®ä¿¡èŠå¤©çª—å£çš„â€œè¡¨æƒ…â€ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹è¿›è¡Œç´¢å¼•æ’åº

| ç´¢å¼• (index) | æè¿° (desc)  | è¡¨æƒ…å (value)     |
|:---:|:-------------:|:----------:|
| 1 | å¾®ç¬‘ | [å¾®ç¬‘] |
| 2 | æ’‡å˜´ | [æ’‡å˜´] |
| 3 | è‰²è‰²è¡¨æƒ… | [è‰²] |
| 4 | å‘å‘† | [å‘å‘†] |
| 5 | å¾—æ„ | [å¾—æ„] |
| 6 | æµæ³ª | [æµæ³ª] |
| 7 | å®³ç¾ | [å®³ç¾] |
| 8 | é—­å˜´ | [é—­å˜´] |
| 9 | ç¡ | [ç¡] |
| 10 | å¤§å“­ | [å¤§å“­] |
| 11 | å°´å°¬ | [å°´å°¬] |
| 12 | å‘æ€’ | [å‘æ€’] |
| 13 | è°ƒçš® | [è°ƒçš®] |
| 14 | å‘²ç‰™ | [å‘²ç‰™] |
| 15 | æƒŠè®¶ | [æƒŠè®¶] |
| 16 | éš¾è¿‡ | [éš¾è¿‡] |
| 17 | å›§ | [å›§] |
| 18 | æŠ“ç‹‚ | [æŠ“ç‹‚] |
| 19 | å | [å] |
| 20 | å·ç¬‘ | [å·ç¬‘] |
| 21 | æ„‰å¿« | [æ„‰å¿«] |
| 22 | ç™½çœ¼ | [ç™½çœ¼] |
| 23 | å‚²æ…¢ | [å‚²æ…¢] |
| 24 | å›° | [å›°] |
| 25 | æƒŠæ | [æƒŠæ] |
| 26 | æ†¨ç¬‘ | [æ†¨ç¬‘] |
| 27 | æ‚ é—² | [æ‚ é—²] |
| 28 | å’’éª‚ | [å’’éª‚] |
| 29 | ç–‘é—® | [ç–‘é—®] |
| 30 | å˜˜ | [å˜˜] |
| 31 | æ™• | [æ™•] |
| 32 | è¡° | [è¡°] |
| 33 | éª·é«… | [éª·é«…] |
| 34 | æ•²æ‰“ | [æ•²æ‰“] |
| 35 | å†è§ | [å†è§] |
| 36 | æ“¦æ±— | [æ“¦æ±—] |
| 37 | æŠ é¼» | [æŠ é¼»] |
| 38 | é¼“æŒ | [é¼“æŒ] |
| 39 | åç¬‘ | [åç¬‘] |
| 40 | å³å“¼å“¼ | [å³å“¼å“¼] |
| 41 | é„™è§† | [é„™è§†] |
| 42 | å§”å±ˆ | [å§”å±ˆ] |
| 43 | å¿«å“­äº† | [å¿«å“­äº†] |
| 44 | é˜´é™© | [é˜´é™©] |
| 45 | äº²äº² | [äº²äº²] |
| 46 | å¯æ€œ | [å¯æ€œ] |
| 47 | ç¬‘è„¸ | [ç¬‘è„¸] |
| 48 | ç”Ÿç—… | [ç”Ÿç—…] |
| 49 | è„¸çº¢ | [è„¸çº¢] |
| 50 | ç ´æ¶•ä¸ºç¬‘ | [ç ´æ¶•ä¸ºç¬‘] |
| 51 | ææƒ§ | [ææƒ§] |
| 52 | å¤±æœ› | [å¤±æœ›] |
| 53 | æ— è¯­ | [æ— è¯­] |
| 54 | å˜¿å“ˆ | [å˜¿å“ˆ] |
| 55 | æ‚è„¸ | [æ‚è„¸] |
| 56 | å¥¸ç¬‘ | [å¥¸ç¬‘] |
| 57 | æœºæ™º | [æœºæ™º] |
| 58 | çš±çœ‰ | [çš±çœ‰] |
| 59 | è€¶ | [è€¶] |
| 60 | åƒç“œ | [åƒç“œ] |
| 61 | åŠ æ²¹ | [åŠ æ²¹] |
| 62 | æ±— | [æ±—] |
| 63 | å¤©å•Š | [å¤©å•Š] |
| 64 | å—¯å—¯å—¯ | [Emm] |
| 65 | ç¤¾ä¼šç¤¾ä¼š | [ç¤¾ä¼šç¤¾ä¼š] |
| 66 | æ—ºæŸ´ | [æ—ºæŸ´] |
| 67 | å¥½çš„ | [å¥½çš„] |
| 68 | æ‰“è„¸ | [æ‰“è„¸] |
| 69 | å“‡ | [å“‡] |
| 70 | ç¿»ç™½çœ¼ | [ç¿»ç™½çœ¼] |
| 71 | 666 | [666] |
| 72 | è®©æˆ‘çœ‹çœ‹ | [è®©æˆ‘çœ‹çœ‹] |
| 73 | å¹æ°” | [å¹æ°”] |
| 74 | è‹¦æ¶© | [è‹¦æ¶©] |
| 75 | è£‚å¼€ | [è£‚å¼€] |
| 76 | å˜´å”‡ | [å˜´å”‡] |
| 77 | çˆ±å¿ƒ | [çˆ±å¿ƒ] |
| 78 | å¿ƒç¢ | [å¿ƒç¢] |
| 79 | æ‹¥æŠ± | [æ‹¥æŠ±] |
| 80 | å¼º | [å¼º] |
| 81 | å¼± | [å¼±] |
| 82 | æ¡æ‰‹ | [æ¡æ‰‹] |
| 83 | èƒœåˆ© | [èƒœåˆ©] |
| 84 | æŠ±æ‹³ | [æŠ±æ‹³] |
| 85 | å‹¾å¼• | [å‹¾å¼•] |
| 86 | æ‹³å¤´ | [æ‹³å¤´] |
| 87 | OK | [OK] |
| 88 | åˆå | [åˆå] |
| 89 | å•¤é…’ | [å•¤é…’] |
| 90 | å’–å•¡ | [å’–å•¡] |
| 91 | è›‹ç³• | [è›‹ç³•] |
| 92 | ç«ç‘° | [ç«ç‘°] |
| 93 | å‡‹è°¢ | [å‡‹è°¢] |
| 94 | èœåˆ€ | [èœåˆ€] |
| 95 | ç‚¸å¼¹ | [ç‚¸å¼¹] |
| 96 | ä¾¿ä¾¿ | [ä¾¿ä¾¿] |
| 97 | æœˆäº® | [æœˆäº®] |
| 98 | å¤ªé˜³ | [å¤ªé˜³] |
| 99 | åº†ç¥ | [åº†ç¥] |
| 100 | ç¤¼ç‰© | [ç¤¼ç‰©] |
| 101 | çº¢åŒ… | [çº¢åŒ…] |
| 102 | ç™¼ | [ç™¼] |
| 103 | ç¦ | [ç¦] |
| 104 | çƒŸèŠ± | [çƒŸèŠ±] |
| 105 | çˆ†ç«¹ | [çˆ†ç«¹] |
| 106 | çŒªå¤´ | [çŒªå¤´] |
| 107 | è·³è·³ | [è·³è·³] |
| 108 | å‘æŠ– | [å‘æŠ–] |
| 109 | è½¬åœˆ | [è½¬åœˆ] |

### 3. å‘èµ·è¯­éŸ³èŠå¤©,é€‚ç”¨äºå•ä¸ªå¥½å‹

ç»™**å•ä¸ª**å¥½å‹å‘èµ·è¯­éŸ³èŠå¤©ï¼Œå¦‚æœæ˜¯ç¾¤èŠï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„```SendVoiceChats```æ–¹æ³•,å‚è€ƒ[ç¾¤èŠä¸­å‘èµ·è¯­éŸ³èŠå¤©](#4-ç¾¤èŠä¸­å‘èµ·è¯­éŸ³èŠå¤©)

- æ–¹æ³•å®šä¹‰
```
public void SendVoiceChat(string who, bool isOpenChat = true)
```

å…¶ä¸­:
  - who: å¥½å‹æ˜µç§°ï¼Œéç¾¤èŠæ˜µç§°
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 4. ç¾¤èŠä¸­å‘èµ·è¯­éŸ³èŠå¤©

åœ¨èŠå¤©å®¤ä¸­å‘èµ·è¯­éŸ³èŠå¤©ï¼Œéœ€è¦æŒ‡å®š**èŠå¤©äºº**

- æ–¹æ³•å®šä¹‰

```
public void SendVoiceChats(string groupName, string[] whos, bool isOpenChat = true) => WxMainWindow.SendVoiceChats(groupName, whos, isOpenChat);
```

å…¶ä¸­:
  - groupName: ç¾¤èŠåç§°
  - whos: å¥½å‹æ˜µç§°åˆ—è¡¨,**å¥½å‹æ˜µç§°**å¿…é¡»åœ¨ç¾¤èŠä¸­
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 5. å‘èµ·ç›´æ’­

ç¾¤èŠä¸­å‘èµ·ç›´æ’­ï¼Œå•ä¸ªå¥½å‹**æ²¡æœ‰**ç›´æ’­åŠŸèƒ½

- æ–¹æ³•å®šä¹‰

```
public void SendLiveStreaming(string groupName, bool isOpenChat = false)
```

å…¶ä¸­:
  - groupName: ç¾¤èŠåç§°
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 6. è·å–å½“å‰èŠå¤©çª—å£çš„æ ‡é¢˜

è·å–ä¸»çª—å£å½“å‰èŠå¤©çš„çª—å£

- æ–¹æ³•å®šä¹‰:

```
public string GetCurrentChatTitle()
```

### 7. ç»™æŒ‡å®šå¥½å‹å‘é€(å¤šä¸ª)æ–‡ä»¶

- æ–¹æ³•å®šä¹‰

```
public async Task SendFile(string who, OneOf<string, string[]> files, bool isOpenChat = false)
```

å…¶ä¸­ï¼š
  - who: å¥½å‹æ˜µç§°
  - files: æ–‡ä»¶è·¯å¾„,å¯ä»¥æ˜¯å•ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶è·¯å¾„ï¼Œè¦æ±‚æ–‡ä»¶å®é™…åœ¨ç£ç›˜ä¸­å­˜åœ¨
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 8. å‘é€æ¶ˆæ¯ç»™å¤šä¸ªå¥½å‹(æ‰¹é‡å‘é€)

ç»™å¤šä¸ªå¥½å‹ï¼ˆåŒ…æ‹¬ç¾¤èŠï¼‰æ‰¹é‡å‘é€åŒæ ·çš„æ¶ˆæ¯

- æ–¹æ³•å®šä¹‰:

```
public async Task SendWhos(string[] whos, string message, OneOf<string, string[]> atUser = default, bool isOpenChat = true)
```

å…¶ä¸­ï¼š
  - whos: å¥½å‹æ˜µç§°åˆ—è¡¨
  - message: æ¶ˆæ¯å†…å®¹
  - atUser: è¢«@çš„å¥½å‹,æœ€ä¸»è¦ç”¨äºç¾¤èŠä¸­@äºº,å¯ä»¥æ˜¯ä¸€ä¸ªå¥½å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªå¥½å‹ï¼Œå¦‚æœæ˜¯è‡ªæœ‰ç¾¤ï¼Œå¯ä»¥@æ‰€æœ‰äººï¼Œä¹Ÿå¯ä»¥@å•ä¸ªå¥½å‹ï¼Œå¾®ä¿¡ä¸æ”¯æŒä»–äººç¾¤@æ‰€æœ‰äºº
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 9. ç»™å¤šä¸ªå¥½å‹å‘é€æ–‡ä»¶

- æ–¹æ³•å®šä¹‰:

```
public async Task SendFiles(string[] whos, OneOf<string, string[]> files, bool isOpenChat = false)
```

å…¶ä¸­ï¼š
  - whos: å¥½å‹æ˜µç§°åˆ—è¡¨
  - files: æ–‡ä»¶è·¯å¾„,å¯ä»¥æ˜¯å•ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶è·¯å¾„ï¼Œè¦æ±‚æ–‡ä»¶å®é™…åœ¨ç£ç›˜ä¸­å­˜åœ¨
  - isOpenChat: æ˜¯å¦æ‰“å¼€å­èŠå¤©çª—å£,é»˜è®¤æ˜¯True:æ‰“å¼€,False:ä¸æ‰“å¼€

### 10. è·å–å¥½å‹æ‰€æœ‰æ¶ˆæ¯åˆ—è¡¨

ç”±äºèŠå¤©å†…å®¹æ¯”è¾ƒé•¿ï¼Œéœ€è¦æŒ‡å®šèŠå¤©é¡µæ•°,å¦‚æœæŒ‡å®šä¸º-1ï¼Œåˆ™è·å–æ‰€æœ‰æ°”æ³¡,æœ‰å¯èƒ½è¢«å¡æ­»

- æ–¹æ³•å®šä¹‰:

```
public List<ChatSimpleMessage> GetChatAllHistory(string who,int pageCount = 10)
```

å…¶ä¸­ï¼š
  - who: å¥½å‹æ˜µç§°ï¼Œå¯ä»¥æ˜¯å¥½å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¾¤èŠåç§°
  - pageCount: è·å–çš„æ°”æ³¡æ•°é‡ï¼Œé»˜è®¤æ˜¯10é¡µ,å¯ä»¥æŒ‡å®šè·å–çš„é¡µæ•°ï¼Œå¦‚æœæŒ‡å®šä¸º-1ï¼Œåˆ™è·å–æ‰€æœ‰æ°”æ³¡

### 11. è½¬å‘æ¶ˆæ¯ç»™å¥½å‹

è½¬å‘æŒ‡å®šçš„æ¶ˆæ¯æ•°é‡ç»™å¥½å‹

- æ–¹æ³•å®šä¹‰:

```
public async Task<bool> ForwardMessage(string fromWho, string toWho, int rowCount = 5)
```

å…¶ä¸­ï¼š
  - fromWho: è½¬å‘æ¶ˆæ¯çš„æ¥æº,å¯ä»¥æ˜¯å¥½å‹æ˜µç§°ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¾¤èŠåç§°
  - toWho: è½¬å‘æ¶ˆæ¯çš„æ¥æ”¶è€…,å¯ä»¥æ˜¯å¥½å‹æ˜µç§°ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¾¤èŠåç§°
  - rowCount: è½¬å‘æ¶ˆæ¯çš„è¡Œæ•°


## ğŸ˜ èŠå¤©è¿‡ç¨‹æ¶ˆæ¯å›å¤

èŠå¤©è¿‡ç¨‹å›å¤æœ€ä¸»è¦ä½¿ç”¨åœ¨**ç›‘å¬**ä¸­ï¼Œä¸€äº›ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š

- ç›‘å¬ä¸å¥½å‹ï¼ˆæˆ–è€…ç¾¤èŠï¼‰èŠå¤©è¿‡ç¨‹ï¼Œå¦‚æœæœ‰å¥½å‹å‘æ¥æ¶ˆæ¯ï¼Œè‡ªåŠ¨åŒ–å›å¤;
- ç›‘å¬æœ‰æ–°å¥½å‹åŠ ä½ ï¼ŒWeChatAuto.SDKè‡ªåŠ¨åŒ–åŠ ä¸Šå¥½å‹åï¼Œè‡ªåŠ¨ç»™æ–°å¥½å‹å‘é€ä¸€äº›æ¶ˆæ¯ï¼Œè‡ªåŠ¨å›å¤æ¶ˆæ¯ç­‰ã€‚

è€ƒè™‘å¦‚ä¸‹æ¨¡æ¿ä»£ç :

```
var builder = Host.CreateApplicationBuilder(args);

WeAutomation.Initialize(builder.Services, options =>
{
});

var serviceProvider = builder.Services.BuildServiceProvider();
var clientFactory = serviceProvider.GetRequiredService<WeChatClientFactory>();
var client = clientFactory.GetWeChatClient("Alex");
//ç›‘å¬ç¾¤ "æµ‹è¯•11" èŠå¤©ï¼Œå¹¶åšè‡ªåŠ¨å›å¤.
await client.AddMessageListener("æµ‹è¯•11", (messageContext) =>
{
  //åœ¨è¿™é‡ŒmessageContextä½¿ç”¨å›å¤ã€è½¬å‘æ¶ˆæ¯
});


var app = builder.Build();
await app.RunAsync();
```

ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼šç›‘å¬æä¾›æ³¨å…¥```messageContext```è¿›è¡Œæ¶ˆæ¯æ“ä½œï¼Œè€Œ```messageContext```æ˜¯ä¸€ä¸ª[MessageContext](../api/WeChatAuto.Models.MessageContext.html)ç±»

### 1. è·å–æˆ‘çš„å¾®ä¿¡æ˜µç§°

```
messageContext.OwnerNickName
```

### 2. è·å–æ–°æ¶ˆæ¯åˆ—è¡¨

```
messageContext.NewMessages
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 3. è·å–æ‰€æœ‰æ¶ˆæ¯åˆ—è¡¨

```
messageContext.AllMessages
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 4. è·å–```Sender```å‘é€å¯¹è±¡
```
messageContext.Sender
```

è¿”å›```Sender```å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ­¤Senderå¯¹è±¡å‘é€æ¶ˆæ¯ç­‰ï¼Œå…·ä½“Senderç±»è¯·å‚è€ƒ[Senderç±»](../api/WeChatAuto.Components.Sender.html)

### 5. è·å–```WeChatClient```å¯¹è±¡

```
messageContext.OwnerClient
```

è·å–åˆ°```WeChatClient```å¯¹è±¡åï¼Œå¯ä»¥å‚ç…§å‰é¢çš„[å•ç‹¬å‘é€æ¶ˆæ¯](#-å•ç‹¬å‘é€æ¶ˆæ¯)çš„å„ä¸ªæ–¹æ³•è¿›è¡Œæ¶ˆæ¯æ“ä½œ,å…·ä½“WeChatClientç±»è¯·å‚ç…§:[WeChatClientç±»](../api/WeChatAuto.Components.WeChatClient.html)

> æ‰€ä»¥ï¼š è™½ç„¶æ˜¯æ¶ˆæ¯ä¸Šä¸‹æ–‡ï¼Œä¹Ÿè·å¾—äº†[å•ç‹¬å‘é€æ¶ˆæ¯](#-å•ç‹¬å‘é€æ¶ˆæ¯)å„ä¸ªèƒ½åŠ›

### 6. è·å–```WeChatClientFactory```å®¢æˆ·ç«¯å·¥å‚å¯¹è±¡
```
messageContext.SystemClientFactory
```

```SystemClientFactory```å±æ€§æœ€ä¸»è¦ç”¨äºå¤šå¾®ä¿¡å®¢æˆ·ç«¯åœºåˆï¼Œè·å–åˆ°```WeChatClientFactory```å¯¹è±¡åï¼Œå¯ä»¥é€šè¿‡```WeChatClientFactory```å¯¹è±¡å‘æœ¬æœºä»»æ„å¾®ä¿¡å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯,æ˜¯ä¸æ˜¯å¾ˆCool!ğŸ˜Š

å…·ä½“WeChatClientFactoryç±»è¯·å‚ç…§ï¼š[WeChatClientFactoryç±»](../api/WeChatAuto.Components.WeChatClientFactory.html)

### 7. è·å–```IServiceProvider```ä¾èµ–æ³¨å…¥æä¾›è€…
```
messageContext.ServiceProvider
```

è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ã€‚é€šè¿‡`IServiceProvider`ï¼Œä½ å¯ä»¥çµæ´»è·å–åˆ°åœ¨ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­æ³¨å†Œçš„ä»»ä½•æœåŠ¡ç±»å¯¹è±¡ï¼Œä»¥ä¾¿åœ¨æ¶ˆæ¯å¤„ç†è¿‡ç¨‹ä¸­è°ƒç”¨ï¼Œä¾‹å¦‚å¤§æ¨¡å‹è‡ªåŠ¨å›å¤æœåŠ¡ã€æ•°æ®åº“ä¸Šä¸‹æ–‡ç­‰ã€‚`messageContext.ServiceProvider` ç›¸å½“äºè¿æ¥ä½ çš„è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘å’Œæ¡†æ¶çš„æ¡¥æ¢ï¼Œå¤§å¤§æå‡æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

### 8. è·å–æ–°æ¶ˆæ¯æ–¹æ³•
```
messageContext.GetNewMessages()
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 9. è·å–æœ€è¿‘æ‰€æœ‰æ¶ˆæ¯æ–¹æ³•
```
messageContext.GetAllMessages()
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 10. è·å–æœ€åå‡ æ¡æ¶ˆæ¯
```
messageContext.GetLastMessages(int count)
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 11. è·å–LLMä¸Šä¸‹æ–‡æ¶ˆæ¯
```
messageContext.GetLLMContextMessages
```

è¿”å›List<string>å¯¹è±¡ï¼Œä»¥ä½œä¸ºå‘ç»™LLMçš„å†å²ä¸Šä¸‹æ–‡åˆ—è¡¨

### 12. è·å–LLMä¸Šä¸‹æ–‡æ¶ˆæ¯(é‡è½½)
```
messageContext.GetLLMContextMessagesTuple
```

è¿”å›```List<(string who, string message)>```å…ƒç»„åˆ—è¡¨,å¯ä»¥é€šè¿‡```List<(string who, string message)>```å…ƒç»„åˆ—è¡¨è‡ªå·±ç»„å»ºLLMçš„å†å²ä¸Šä¸‹æ–‡

### 13. æ˜¯å¦è¢«äººæ‹ä¸€æ‹
```
messageContext.IsBeTap()
```

è¿”å›```True```æˆ–è€…```False```,ç¡®å®šè‡ªå·±æ˜¯å¦è¢«äººæ‹ä¸€æ‹

### 14. æ˜¯å¦è¢«å…¶ä»–äºº@æˆ‘
```
messageContext.IsBeAt()
```

ç¡®å®šæ˜¯å¦è¢«å…¶ä»–äºº@æˆ‘

### 15. è·å–è¢«@çš„æ¶ˆæ¯åˆ—è¡¨
```
messageContext.MessageBubbleIsBeAt()
```

è·å–è¢«@çš„æ¶ˆæ¯æ°”æ³¡åˆ—è¡¨,å¯ä»¥é€šè¿‡æ¶ˆæ¯åˆ—è¡¨è·å–è°@äº†æˆ‘ï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ

### 16. æˆ‘çš„æ¶ˆæ¯æ˜¯å¦è¢«å¼•ç”¨
```
messageContext.IsBeReferenced
```

è¿”å›```True```æˆ–è€…```False```,ç¡®å®šè‡ªå·±æ¶ˆæ¯è¢«äººå¼•ç”¨

### 17. è·å–æˆ‘çš„è¢«å¼•ç”¨çš„æ¶ˆæ¯åˆ—è¡¨
```
messageContext.MessageBubbleIsReferenced()
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 18. è·å–å¼•ç”¨ä¸­æˆ‘è‡ªå·±çš„æ¶ˆæ¯åˆ—è¡¨
```
messageContext.MessageBubbleIsReferencing()
```

è¿”å›```List<MessageBubble>```åˆ—è¡¨,å…·ä½“```MessageBubble```æ¶ˆæ¯ç±»è¯·å‚è€ƒ[MessageBubble](../api/WeChatAuto.Components.MessageBubble.html)

### 19. å‘é€æ–‡å­—æ¶ˆæ¯
```
messageContext.SendMessage(string message, List<string> atUserList = null)
```

å…¶ä¸­:
  - message: æ¶ˆæ¯å†…å®¹
  - atUserList: è¢«@çš„å¥½å‹åˆ—è¡¨


> å…¶ä»–æ›´å¤šæ“ä½œè¯·å‚è§```MessageContext```ç±»ï¼š [MessageContextç±»](../api/WeChatAuto.Models.MessageContext.html)